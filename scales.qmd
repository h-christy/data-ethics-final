---
title: "Scaling Tolerance and Fear"
---

## H-technique

consistency, can't reproduce the same result[]
```{.r}
> df54 |> count(tolerance_group)
# A tibble: 6 × 2
  tolerance_group     n
  <chr>           <int>
1 tolerance0        730
2 tolerance1       1053
3 tolerance2       1085
4 tolerance3       1495
5 tolerance4        649
6 tolerance5       1421

> code_df |> count(danger_group, .drop = FALSE)
# A tibble: 6 × 2
  danger_group     n
  <chr>        <int>
1 danger0        999
2 danger1        851
3 danger2       4336
4 danger3        151
5 danger4         32
6 danger5         64
```
```{r}
library(tidyverse)
```

```{r}
code_df <- read_csv('data/labeled-bind.csv')
```

```{r}
# code_df |> head(4) |> View()
```


## Scale1: Willingness to Tolerate Nonconformist

The merit of this study is that Stouffer has been very trasparent, and allow us to trace how he operationalized the abstract, not defined "tolerance"

### 0 to 5: Scaling Individual Tolerance

```{r}
code_df <- code_df |> mutate(tolerance_group = NA_character_)
```
```{r}
condition_filter <- function(df, condition, group_name){
  df <- df |> mutate(
    tolerance_group = case_when(
      is.na(tolerance_group) & !!rlang::enquo(condition) ~ group_name,
      TRUE ~ tolerance_group
    )
  )
  return(df)
}
```

```{r}
code_df <- code_df |> condition_filter(
  ((v100 == 1) + (v101 == 5) + (v102 == 5) >= 2) & ((v104 == 5) + (v32 == 1) + (v34 == 5) >= 2) & 
  ((v112 == 5) + (v35 == 1) + (v37 == 5) >= 2) &
  ((v108 == 5) + (v109 == 1) + (v113 == 5) >= 2) &
  ((v106 == 5) + (v107 == 5) + (v110 == 5) + (v106 == 8) + (v107 == 8) + (v110 == 8) >= 2),
  "tolerance5"
)
code_df <- code_df |> condition_filter(
  ((v104 == 5) + (v32 == 1) + (v34 == 5) >= 2) & 
  ((v112 == 5) + (v35 == 1) + (v37 == 5) >= 2) &
  ((v108 == 5) + (v109 == 1) + (v113 == 5) >= 2) &
  ((v106 == 5) + (v107 == 5) + (v110 == 5) + (v106 == 8) + (v107 == 8) + (v110 == 8) >= 2),
  "tolerance4"
)
code_df <- code_df |> condition_filter(
  ((v112 == 5) + (v35 == 1) + (v37 == 5) >= 2) &
  ((v108 == 5) + (v109 == 1) + (v113 == 5) >= 2) &
  ((v106 == 5) + (v107 == 5) + (v110 == 5) + (v106 == 8) + (v107 == 8) + (v110 == 8) >= 2),
  "tolerance3"
)
code_df <- code_df |> condition_filter(
  ((v108 == 5) + (v109 == 1) + (v113 == 5) >= 2) &
  ((v106 == 5) + (v107 == 5) + (v110 == 5) + (v106 == 8) + (v107 == 8) + (v110 == 8) >= 2),
  "tolerance2"
)
code_df <- code_df |> condition_filter(
  ((v106 == 5) + (v107 == 5) + (v110 == 5) + (v106 == 8) + (v107 == 8) + (v110 == 8) >= 2),
  "tolerance1"
)
code_df <- code_df |> mutate(
  tolerance_group = ifelse(
    is.na(tolerance_group), "tolerance0", tolerance_group
    )
  )
```
```{r}
code_df |> count(tolerance_group,.drop = FALSE)
```

```{r}
code_df |> count(leader, tolerance_group) |> group_by(leader) |> mutate(pct = (n / sum(n)) * 100) |> ungroup() |> View()
```

### Broader Tolerance Rank Groups: `less tolerant`, `in-between` and `more tolerant`

```{r}
code_df <- code_df |> mutate(tolerance_broader = case_when(
    tolerance_group %in% c('tolerance0', 'tolerance1') ~ 'less tolerant',
    tolerance_group %in% c('tolerance2', 'tolerance3') ~ 'in-between',
    TRUE ~ 'more tolerant'
))
```

```{r}
code_df |> filter(leader == 1) |> count(tolerance_broader) |> mutate(pct = (n / sum(n)) * 100)
```


## Scale2: Scale of the Perception on the Internal Communist Danger

```{r}
code_df <- code_df |> mutate(danger_group = NA_character_)
```

#### function `condition_filter2()`

```{r}
condition_filter2 <- function(df, condition, group_name){
  df <- df |> mutate(
    danger_group = case_when(
      is.na(danger_group) & !!rlang::enquo(condition) ~ group_name,
      TRUE ~ danger_group
    )
  )
  return(df)
}
```
```{r}
code_df <- code_df |> condition_filter2(
  ((v75 == 1) + (v66 == 1) + (v44 == 1) + (v44 == 2) >= 3) & ((v72 == 1) + (v72 == 2) + (v72 == 8) + (v71 == 8) >= 1) & ((v69 == 1) + (v69 == 2) + (v69 == 8) + (v68 == 8) >= 1),
  "danger5"
)
code_df <- code_df |> condition_filter2(
  ((v66 == 1) + (v44 == 1) + (v44 == 2) >= 2) & ((v72 == 1) + (v72 == 2) + (v72 == 8) + (v71 == 8) >= 1) & ((v69 == 1) + (v69 == 2) + (v69 == 8) + (v68 == 8) >= 1),
  "danger4"
)
code_df <- code_df |> condition_filter2(
  ((v44 == 1) + (v44 == 2) >= 1) & ((v72 == 1) + (v72 == 2) + (v72 == 8) + (v71 == 8) >= 1) & ((v69 == 1) + (v69 == 2) + (v69 == 8) + (v68 == 8) >= 1),
  "danger3"
)
code_df <- code_df |> condition_filter2(
  ((v72 == 1) + (v72 == 2) + (v72 == 8) + (v71 == 8) >= 1) & ((v69 == 1) + (v69 == 2) + (v69 == 8) + (v68 == 8) >= 1),
  "danger2"
)
code_df <- code_df |> condition_filter2(
  ((v69 == 1) + (v69 == 2) + (v69 == 8) + (v68 == 8) >= 1),
  "danger1"
)
code_df <- code_df |> mutate(
  danger_group = ifelse(
    is.na(danger_group), "danger0", danger_group
    )
  )
```
```{r}
code_df |> count(danger_group, .drop = FALSE)
```

## Grouping: more interested and less interested


```{r}
code_df <- code_df |> mutate(interested = case_when(
    v123 == 1 ~ 'more',
    v123 == 2 ~ 'more',
    TRUE ~ 'less'
)
)
```

```{r}
code_df |> filter(leader == 0) |> count(interested) |> mutate((n/sum(n)) * 100)
```